---
title: "data_generation"
author: "Jack Thomas"
date: "5/9/2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Data generation for Blanc et al. model.

```{r define}
# number of sites in the study
nsites <- 4

# number of individuals in capture history
n <- 10

# number of sampling occasions in capture-recapture
nsample_cap <- 5

# number of sampling occasions in presence-absence
nsample_occ <- 7

# capture probability
p <- 0.5

# occupancy probability
occupancy <- 0.3
```


# Simulate Individuals

```{r individuals}
set.seed(1234)
# our study area is the unit square

# define homerange centers

# Poisson process, with x, y coordinates as independent uniform
# random variables

homeranges <- array(data = NA, dim = c(n, 2),dimnames = list(c(1:n),c("x","y")))

for (i in 1:n) {
  x <- runif(1)
  y <- runif(1)
  homeranges[i, 1] <- x
  homeranges[i, 2] <- y
}

# plotting homeranges for validation
par(pty="s")
plot(homeranges)

```



```{r datagen}

# seed set for testing purposes only
set.seed(1234)


# empty capture history matrix
cap_hist <- array(NA, dim = c(n, nsample_cap))

# empty presence-absence matrix
pres_abs <- array(0, dim = c(nsites, nsample_occ))

# Capture history generation
for (i in 1:n) {
  for (j in 1:nsample_cap) {
    rv <- runif(1)
    if (p <= rv) {
      cap_hist[i, j] <- 1
    } else {
      cap_hist[i, j] <- 0
    }
  }
}

# Presence-absence generation
for (i in 1:nsites) {
  for (j in 1:nsample_cap) {
    rv <- runif(1)
    if (occupancy <= rv) {
      pres_abs[i, j] <- 1
    }
  }
}
```

```{r output}
# write data to files
write(cap_hist, file = "capture-recapture-data.txt")
write.table(pres_abs, file = "presence-absence-data.csv", col.names = FALSE, row.names = FALSE, sep = ",")
```
